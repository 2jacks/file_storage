var u=Object.defineProperty;var p=(a,e,t)=>e in a?u(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var s=(a,e,t)=>(p(a,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();const f=[{name:"f_a",data:[{name:"a.js",content:'console.log("a.js")',description:"A JS FILE"},{name:"b.js",content:'console.log("b.js")',description:"B JS FILE"},{name:"f_b",data:[{name:"d.js",content:'console.log("d.js")',description:"D JS FILE"}]},{name:"c.js",content:'console.log("c.js")',description:"C JS FILE"}]}],m=""+new URL("sprite-d308057c.svg",import.meta.url).href;class d{constructor({fs:e,parent:t,name:n,data:i,buildTree:r}){s(this,"_data");s(this,"_name");s(this,"children");s(this,"buildTree");s(this,"fs");s(this,"parent");s(this,"element");s(this,"container");s(this,"isOpened",!1);s(this,"isSelected",!1);s(this,"toggle",e=>{e.stopPropagation(),this.isOpened=!this.isOpened,this.element&&(this.isOpened?this.element.classList.add("explorer__item--closed"):this.element.classList.remove("explorer__item--closed"))});s(this,"select",()=>{this.fs.selectItem(this)});this.fs=e,this.parent=t,this._name=n,this.element=this.render(),this.container=this.element.querySelector(".explorer__list"),this.buildTree=r,this._data=i,this.children=this.buildTree(i)}get name(){return this._name}set name(e){this._name=e,this.update()}delete(){this.children.forEach(e=>{e.delete()})}removeChild(e){this.fs.removeChild.call(this,e)}update(){var e;(e=this.element)==null||e.remove(),this.element=this.render(),this.container=this.element.querySelector(".explorer__list"),this.children.forEach(t=>t.update())}render(){var l;const e=document.createElement("li");e.classList.add("explorer__item");const t=document.createElement("div");t.classList.add("explorer__item-header"),t.addEventListener("click",this.select),e.appendChild(t);const n=document.createElement("div");n.classList.add("explorer__item-arrow"),n.insertAdjacentHTML("afterbegin",` <svg>
        	<use xlink:href="${m}#arrow" />
      	</svg>
			`),n.addEventListener("click",this.toggle),t.appendChild(n);const i=document.createElement("div");i.classList.add("explorer__item-icon"),i.insertAdjacentHTML("afterbegin",` <svg>
        	<use xlink:href="${m}#folder" />
      	</svg>
			`),t.appendChild(i);const r=document.createElement("div");r.classList.add("explorer__item-name"),t.appendChild(r),r.innerHTML=this._name||"";const o=document.createElement("div");return o.classList.add("explorer__list"),e.insertAdjacentElement("beforeend",o),(l=this.parent.container)==null||l.insertAdjacentElement("afterbegin",e),e}}class c{constructor({fs:e,parent:t,name:n,description:i,content:r}){s(this,"_name");s(this,"description");s(this,"content");s(this,"fs");s(this,"parent");s(this,"element");s(this,"isOpened",!1);s(this,"isSelected",!1);s(this,"onClick",()=>{this.fs.selectItem(this)});s(this,"delete",()=>{this.element.remove(),this.parent.removeChild(this.name)});this.fs=e,this.parent=t,this._name=n,this.description=i,this.content=r,this.element=this.render()}get name(){return this._name}set name(e){this._name=e,this.update()}update(){var e;(e=this.element)==null||e.remove(),this.element=this.render()}render(){var r;const e=document.createElement("li");e.classList.add("explorer__item");const t=document.createElement("div");if(t.classList.add("explorer__item-header"),e.appendChild(t),t.addEventListener("click",this.onClick),this.description){const o=document.createElement("div");o.classList.add("explorer__item-hint"),o.innerHTML=`
      <div class="hint__container">
        ${this.description}
      </div>
    `,t.appendChild(o)}const n=document.createElement("div");n.classList.add("explorer__item-icon"),n.insertAdjacentHTML("afterbegin",` <svg>
        	<use xlink:href="${m}#file" />
      	</svg>
			`),t.insertAdjacentElement("afterbegin",n);const i=document.createElement("div");return i.classList.add("explorer__item-name"),t.appendChild(i),i.innerHTML=this._name||"",(r=this.parent.container)==null||r.insertAdjacentElement("afterbegin",e),e}}function h(a){return typeof(a==null?void 0:a.content)=="string"}function _(a){return!h(a)}function v(a,e){var t=new FileReader;t.readAsText(a),t.onload=n=>{e(n)},t.onerror=function(){console.log("Error creating file")}}function E(a,e){var t=document.createElement("a");t.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),t.setAttribute("download",a),t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t)}class b{constructor({fs:e,data:t,root:n}){s(this,"fs");s(this,"root");s(this,"element");s(this,"container");s(this,"data");s(this,"children");if(this.fs=e,this.root=n,!this.root)throw new Error("Error creating Explorer");this.data=t,this.element=this.render(),this.container=this.element.querySelector(".explorer__list"),this.children=this.buildTree(this.data)}buildTree(e){let t=[];return e.forEach(n=>{h(n)&&t.push(new c({fs:this.fs,parent:this,name:n.name,description:n.description,content:n.content,root:this.container})),_(n)&&t.push(new d({fs:this.fs,parent:this,name:n.name,data:n.data,buildTree:this.buildTree,root:this.container}))}),t}removeChild(e){this.children=this.children.filter(t=>t.name!==e)}render(){var i;const e=document.createElement("div");e.classList.add("explorer");const t=document.createElement("div");t.classList.add("explorer__container"),e.insertAdjacentElement("afterbegin",t);const n=document.createElement("div");return n.classList.add("explorer__list"),t.insertAdjacentElement("afterbegin",n),(i=this.root)==null||i.insertAdjacentElement("afterbegin",e),e}}function L(a,e){var n,i;const t=document.createElement("div");return t.classList.add("modal"),t.innerHTML=`
    <div class="modal__container">
      <div class="modal__body">
        <input type="text" placeholder="Введите имя папки"/>
        <div class="modal__body-button-group">
          <button data-action="ok">Создать</button>
          <button data-action="cancel">Отмена</button>
        </div>
      </div>
    </div>
	`,(n=t.querySelector('[data-action="ok"]'))==null||n.addEventListener("click",()=>{var o;const r=(o=t.querySelector("input"))==null?void 0:o.value;a(r),t.remove()}),(i=t.querySelector('[data-action="cancel"]'))==null||i.addEventListener("click",()=>{var o;const r=(o=t.querySelector("input"))==null?void 0:o.value;typeof e=="function"&&e(r),t.remove()}),t}function g(a,e,t){var i,r;const n=document.createElement("div");return n.classList.add("modal"),n.innerHTML=`
    <div class="modal__container">
      <div class="modal__body">
				<div>Переименовать ${a}</div>
        <input type="text" placeholder="Введите новое имя"/>
        <div class="modal__body-button-group">
          <button data-action="ok">Переименовать</button>
          <button data-action="cancel">Отмена</button>
        </div>
      </.div>
    </div>
	`,(i=n.querySelector('[data-action="ok"]'))==null||i.addEventListener("click",()=>{var l;const o=(l=n.querySelector("input"))==null?void 0:l.value;e(o),n.remove()}),(r=n.querySelector('[data-action="cancel"]'))==null||r.addEventListener("click",()=>{var l;const o=(l=n.querySelector("input"))==null?void 0:l.value;typeof t=="function"&&t(o),n.remove()}),n}class y{constructor({fs:e,root:t}){s(this,"fs");s(this,"root");s(this,"element");s(this,"openCreateFolderModal",()=>{this.fs.root.appendChild(L(this.fs.onCreateFolder))});s(this,"openRenameModal",()=>{this.fs.root.appendChild(g(this.fs.selectedItem.name,this.fs.onRename))});if(this.fs=e,this.root=t,!this.root)throw new Error("Error creating MenuBar");this.element=this.render()}render(){var t,n,i,r,o,l;const e=document.createElement("div");return e.insertAdjacentHTML("afterbegin",`
			  <menu class="menu-bar">
            <li class="menu-bar__item" data-action="createFolder">
              <span class="menu-bar__item-name">Создать папку</span>
            </li>
            <li class="menu-bar__item" data-action="uploadFile">
              <span class="menu-bar__item-name">Загрузить файл</span>
              <input type="file">
            </li>
            <li class="menu-bar__item" data-action="downloadFile">
              <span class="menu-bar__item-name">Скачать файл</span>
            </li>
            <li class="menu-bar__item" data-action="deleteFolder">
              <span class="menu-bar__item-name">Удалить</span>
            </li>
            <li class="menu-bar__item" data-action="rename">
              <span class="menu-bar__item-name">Переименовать</span>
            </li>
        </menu>
		`),(t=this.root)==null||t.insertAdjacentElement("afterbegin",e),(n=e.querySelector('[data-action="createFolder"]'))==null||n.addEventListener("click",this.openCreateFolderModal),(i=e.querySelector('[data-action="deleteFolder"]'))==null||i.addEventListener("click",this.fs.onDeleteFolder),(r=e.querySelector('[data-action="uploadFile"] input'))==null||r.addEventListener("change",this.fs.onUploadFile),(o=e.querySelector('[data-action="downloadFile"]'))==null||o.addEventListener("click",this.fs.onDownloadFile),(l=e.querySelector('[data-action="rename"]'))==null||l.addEventListener("click",this.openRenameModal),e}}class F{constructor({fs:e,parent:t}){s(this,"fs");s(this,"parent");s(this,"element");this.fs=e,this.parent=t,this.element=this.render(),this.parent.container.insertAdjacentElement("beforeend",this.element)}update(){this.element.remove(),this.element=this.render(),this.parent.container.insertAdjacentElement("beforeend",this.element)}render(){var n,i;const e=document.createElement("div");e.classList.add("viewer"),e.innerHTML=`
	
        <div class="viewer__container">
          <div class="opened-files">
            <ul class="opened-files__container">
	
						</ul>
					</div>
					<div class="opened-files__content">
          <div><xmp>${((n=this.fs.selectedItem)==null?void 0:n.content)||""}</xmp></div>
          </div>
				</div>
	
		`;const t=e.querySelector(".opened-files__container");for(let r of this.fs.openedFiles){const o=document.createElement("li");o.classList.add("opened-files__item"),r.isSelected&&o.classList.add("selected"),o.addEventListener("click",l=>{l.stopPropagation(),this.fs.selectItem(r)}),o.innerHTML=`
                    <h4 class="opened-files__item-name">${r.name}</h4>
                    <div class="opened-files__item-close-button">X</div>
								`,(i=o.querySelector(".opened-files__item-close-button"))==null||i.addEventListener("click",l=>{l.stopPropagation(),this.fs.openedFiles.delete(r),this.update()}),t==null||t.append(o)}return e}}class I{constructor({root:e,data:t}){s(this,"root");s(this,"element");s(this,"container");s(this,"data");s(this,"explorer");s(this,"menuBarContainer");s(this,"menuBar");s(this,"children",null);s(this,"selectedItem",null);s(this,"openedFiles",new Set);s(this,"viewer");s(this,"onDeleteFolder",e=>{var t,n,i,r;(n=(t=this.selectedItem)==null?void 0:t.element)==null||n.remove(),this.openedFiles.delete(this.selectedItem),(r=(i=this.selectedItem)==null?void 0:i.children)==null||r.forEach(o=>{this.selectedItem.removeChild(o.name),this.openedFiles.delete(o),this.viewer.update()}),this.selectedItem.parent.removeChild(this.selectedItem.name),this.viewer.update()});s(this,"onCreateFolder",e=>{var n;const t=this.selectedItem instanceof d?this.selectedItem:this.selectedItem.parent;(n=t.children)==null||n.push(new d({fs:this,root:t.container,name:e,parent:t,buildTree:t.buildTree,data:[]}))});s(this,"onDeleteFile",()=>{var e,t,n;(t=(e=this.selectedItem)==null?void 0:e.element)==null||t.remove(),(n=this.selectedItem)==null||n.parent.removeChild(this.selectedItem.name),this.openedFiles.delete(this.selectedItem),this.viewer.update()});s(this,"onUploadFile",e=>{const t=e.target.files[0],n=t.name;e.target.value=null,t&&v(t,i=>{var o,l;const r=this.selectedItem instanceof d?this.selectedItem:this.selectedItem.parent;(l=r.children)==null||l.push(new c({fs:this,parent:r,name:n,description:null,content:((o=i.target)==null?void 0:o.result)||""}))})});s(this,"onDownloadFile",()=>{this.selectedItem instanceof c&&E(this.selectedItem.name,this.selectedItem.content||"")});s(this,"onRename",e=>{this.selectedItem.name=e,this.viewer.update()});if(this.root=document.querySelector(e),!this.root)throw new Error("Error creating FileStorage");this.element=this.render(),this.container=this.element.querySelector(".main"),this.data=t,this.menuBarContainer=this.element.querySelector(".file-storage__container"),this.menuBar=new y({fs:this,root:this.menuBarContainer}),this.explorer=new b({fs:this,data:this.data,root:this.container}),this.viewer=new F({fs:this,parent:this})}selectItem(e){var t,n;if(this.root&&e){e instanceof c&&this.openedFiles.add(e);const i=this.root.querySelectorAll(".selected");i&&i.forEach(r=>{r.classList.remove("selected")}),this.selectedItem&&(this.selectedItem.isSelected=!1),this.selectedItem=e,this.selectedItem.isSelected=!0,(n=(t=this.selectedItem)==null?void 0:t.element)==null||n.classList.add("selected"),this.viewer.update()}}removeChild(e){this.children=this.children.filter(t=>t.name!==e)}update(){var e,t;(e=this.root)==null||e.replaceChildren(this.element),this.element=this.render(),(t=this.root)==null||t.replaceChildren(this.element)}render(){var i;const e=document.createElement("div");e.classList.add("file-storage");const t=document.createElement("div");t.classList.add("file-storage__container"),e.insertAdjacentElement("afterbegin",t);const n=document.createElement("div");return n.classList.add("main"),t.insertAdjacentElement("afterbegin",n),(i=this.root)==null||i.insertAdjacentElement("afterbegin",e),e}}new I({root:"#app",data:f});
